<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hamster Kombat</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREQAAAAAAEAAAEAAAAAEAAAABAAAAEAAAAAAQAAAQAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAP+AAAH/gAAB/4AAAf+AAAP/AAAB/4AAA/+AAAP/gAAD/4AAA/+AAAP/wAAD/8AAA//gAAP/4AAA/+AAAP/gAAD/4AA" type="image/x-icon">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div id="top-stats">
        <div id="level-info">
            <span>GOLD 1/10</span>
            <div id="level-progress"></div>
            <span id="profit-per-hour">0</span>
        </div>
        <button id="settings-button" onclick="showOther()">‚öôÔ∏è</button>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <div id="tabs" class="nav-bar">
        <button class="tab-button active" onclick="showTab('exchange')">–ë–∏—Ä–∂–∞</button>
        <button class="tab-button" onclick="showTab('mine')">–ú–∞–π–Ω–∏–Ω–≥</button>
        <button class="tab-button" onclick="showTab('friends')">–î—Ä—É–∑—å—è</button>
        <button class="tab-button" onclick="showTab('earn')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫</button>
        <button class="tab-button" onclick="showTab('airdrop')">–≠–π—Ä–¥—Ä–æ–ø</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="main-content">
        <button class="back-button hk-button" onclick="goBack()" style="display: none;">–ù–∞–∑–∞–¥ ‚¨ÖÔ∏è</button>
        <div id="tap-container">
            <div id="tap-button">
                <span>üòà</span>
                <div id="energy-counter">100/100</div>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div id="bottom-bar" class="nav-bar">
        <div style="display: flex; flex: 1;">
            <button class="nav-button active" data-action="showMain">
                <span>–ë–∏—Ä–∂–∞</span>
            </button>
            <button class="nav-button" data-action="showGames">
                <span>–ö–∞–∑–∏–Ω–æ</span>
            </button>
            <button class="nav-button" data-action="showRewards">
                <span>–ù–∞–≥—Ä–∞–¥—ã</span>
            </button>
            <button class="nav-button" data-action="showFriends">
                <span>–î—Ä—É–∑—å—è</span>
            </button>
            <button class="nav-button" data-action="showBonuses">
                <span>–ë–æ–Ω—É—Å—ã üéÅ</span>
            </button>
        </div>
        <div style="display: flex; flex: 1; justify-content: flex-end;">
            <button class="nav-button" data-action="showBoosts">
                <span>–ë—É—Å—Ç</span>
            </button>
            <button class="nav-button" data-action="showAdminPanel">
                <span>–ê–¥–º–∏–Ω</span>
            </button>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="ui-main.js"></script>
    <script src="game-mini.js"></script>
    <script src="settings.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const isTelegram = window.Telegram && window.Telegram.WebApp;
            if (isTelegram) {
                try {
                    window.Telegram.WebApp.ready();
                    window.Telegram.WebApp.expand();
                    window.Telegram.WebApp.setHeaderColor({ color: '#1C2526' });
                    window.Telegram.WebApp.setBottomBarColor({ color: '#1C2526' });
                    window.Telegram.WebApp.requestTheme();
                    window.Telegram.WebApp.requestViewport();
                    window.Telegram.WebApp.requestSafeArea();
                    window.Telegram.WebApp.requestContentSafeArea();
                    const user = window.Telegram.WebApp.initDataUnsafe.user;
                    window.profile.username = user ? (user.username || user.first_name || '–ê–Ω–æ–Ω–∏–º') : '–ê–Ω–æ–Ω–∏–º';
                    window.showNotification(`–ü—Ä–∏–≤–µ—Ç, ${window.profile.username}! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà`);
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–∞ Telegram API:', e);
                    window.profile.username = '–ê–Ω–æ–Ω–∏–º';
                    window.showNotification('–ü—Ä–∏–≤–µ—Ç, –ê–Ω–æ–Ω–∏–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà');
                }
            } else {
                console.warn('Telegram WebApp SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –±–µ–∑ Telegram.');
                window.profile.username = '–ê–Ω–æ–Ω–∏–º';
                window.showNotification('–ü—Ä–∏–≤–µ—Ç, –ê–Ω–æ–Ω–∏–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà');
            }

            loadProfile();
            updateProfile();
            applyTheme();

            document.getElementById('tap-button').addEventListener('click', window.clickTapButton);

            function bindNavEvents() {
                document.querySelectorAll('.nav-button').forEach(button => {
                    button.removeEventListener('click', handleNavClick);
                    button.addEventListener('click', handleNavClick);
                });
            }

            function handleNavClick(event) {
                const action = event.currentTarget.getAttribute('data-action');
                document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                event.currentTarget.classList.add('active');
                if (action && window[action]) {
                    window[action]();
                } else {
                    console.error(`Function ${action} is not defined.`);
                }
            }

            bindNavEvents();

            window.goBack = function() {
                if (historyStack.length > 1) {
                    historyStack.pop();
                    const lastSection = historyStack[historyStack.length - 1];
                    if (lastSection === 'main') {
                        showMain();
                    } else if (window[lastSection]) {
                        window[lastSection]();
                    }
                } else {
                    showMain();
                }
            };

            setInterval(updateEnergy, 100);
        });
    </script>
</body>
</html>